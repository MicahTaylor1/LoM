:root {
  --bg:#0f0f11; --panel:#141417; --ink:#e8e8ea; --muted:#a7a7ad; 
  --accent:#d0b36e; --accent-2:#735c2e; --danger:#c74b4b; --ok:#59b36c; 
  --grid:#22222a; --tab:#1a1a20; --tab-border:#2b2b34; --tab-active:#202029; 
  --tab-ind:#c8aa63;
}

* { box-sizing:border-box; }
html, body { height:100%; }

body {
  margin:0;
  background:radial-gradient(1000px 600px at 120% -20%, #2c2c31 0%, #15151a 45%, #0f0f11 100%);
  color:var(--ink);
  font:14px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, sans-serif;
}

/* Typography */
h1,h2 { margin:0 0 .5rem 0; font-weight:700; letter-spacing:.4px; }
h1 { font-size:1.6rem; }
h2 { font-size:1.1rem; color:var(--accent); }

.wrap { max-width:1100px; margin:24px auto; padding:0 16px; }
.row { display:flex; gap:10px; flex-wrap:wrap; align-items:center; }

/* Panels */
.panel {
  background:linear-gradient(180deg, #17171b 0%, #101015 100%);
  border:1px solid var(--grid); border-radius:14px; padding:14px;
  box-shadow:0 1px 0 #000, inset 0 1px 0 rgba(255,255,255,.04);
}

/* Forms */
label { font-size:.8rem; color:var(--muted); }
input[type="text"], input[type="number"], select, textarea {
  width:100%; background:#0e0e12; color:var(--ink); border:1px solid #2a2a32;
  border-radius:10px; padding:8px 10px; outline:none;
}
input[type="number"] { appearance:textfield; }
textarea { min-height:80px; resize:vertical; }

/* Layout utilities */
.field { flex:1 1 140px; }
.small { flex:0 0 110px; }
.mini { flex:0 0 80px; }

/* Buttons */
.btn {
  background:linear-gradient(180deg,#2a2a33,#1e1e26);
  color:var(--ink); border:1px solid #34343f;
  padding:8px 12px; border-radius:10px; cursor:pointer;
}
.btn:hover { filter:brightness(1.07); }
.btn.ghost { background:transparent; }
.btn.accent { background:linear-gradient(180deg,#c8aa63,#a88a43); border-color:#b89a53; color:#181818; }
.btn.danger { border-color:#5a2222; background:linear-gradient(180deg,#6b2626,#451717); color:#f3dada; }

/* Misc Elements */
.pill { padding:4px 8px; border-radius:999px; background:#1a1a22; border:1px solid #30303a; font-size:.78rem; color:#cfcfd6; }
.grid { display:grid; gap:14px; }
.cols-3 { grid-template-columns:1.1fr 1.3fr 1fr; }
.kpi { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; }
.kpi .box {
  background:#0f0f14; border:1px solid #2a2a33; border-radius:12px;
  padding:10px; text-align:center;
}
.kpi .box h3 { margin:2px 0 6px 0; font-size:.78rem; color:var(--muted); }
.kpi .box input { width:100%; text-align:center; font-weight:700; }
.hr { height:1px; background:#22222a; margin:12px 0; }

table { width:100%; border-collapse:collapse; }
th,td { border-bottom:1px solid #24242b; padding:8px 6px; text-align:left; }
th { color:var(--muted); font-weight:600; font-size:.86rem; }
.right { text-align:right; }
.muted { color:var(--muted); }
.total { font-weight:700; }

/* HP Tracker */
.hp {
  display:inline-flex; align-items:center; gap:6px;
  border:1px solid #34343f; background:#14141b;
  padding:6px 8px; border-radius:999px;
  box-shadow:inset 0 1px 0 rgba(255,255,255,.04);
}
.hp label { color:#cfcfd6; font-size:.78rem; }
.hp input {
  width:52px; text-align:center; background:#0d0d12;
  border:1px solid #2a2a33; color:var(--ink);
  padding:6px 8px; border-radius:8px; font-weight:700;
}
.hp .sep { color:#565662; font-weight:700; }
.hp .pct { min-width:48px; text-align:right; font-weight:700; }
.hp .hbtn {
  border:0; background:transparent; color:#ddd;
  padding:6px 8px; cursor:pointer; border-radius:8px; font-weight:700;
}
.hp .hbtn:hover { background:#1a1a22; }
.hp .hbtn:active { transform:translateY(1px); }
.hp.ok .pct { color:var(--ok); }
.hp.warn .pct { color:#d5b34d; }
.hp.danger .pct { color:var(--danger); }

/* Tabs */
.tabs {
  position:sticky; top:0; z-index:10;
  margin:10px 0 16px 0;
  background:linear-gradient(180deg, rgba(20,20,25,.85), rgba(10,10,15,.85));
  backdrop-filter:blur(8px);
  border:1px solid var(--tab-border);
  border-radius:14px;
  overflow:hidden;
}
.tabbar {
  display:flex; position:relative; gap:0;
  border-bottom:1px solid var(--tab-border);
}
.tabbtn {
  flex:1 1 auto; text-align:center; padding:10px 12px; cursor:pointer;
  background:var(--tab); color:#cfcfd6; border:0; font-weight:600;
  letter-spacing:.2px; transition:filter .15s ease;
}
.tabbtn:hover { filter:brightness(1.06); }
.tabbtn.active { color:#fff; background:var(--tab-active); }
.tab-indicator {
  position:absolute; bottom:0; height:2px; width:16.66%;
  left:0; background:var(--tab-ind);
  transition:left .22s ease, width .22s ease;
}
.tabcontent { display:none; padding:12px; }
.tabcontent.active { display:block; }

/* Backstory preview */
.backstory-wrap { display:grid; grid-template-columns:1fr 1fr; gap:12px; }
.preview {
  background:#0e0e12; border:1px solid #2a2a32; border-radius:10px;
  padding:10px; overflow:auto; min-height:240px;
}
.preview h1,.preview h2,.preview h3 { color:#e9dfc8; margin:.6em 0 .3em; }
.preview p { margin:.4em 0; }
.preview code { background:#15151b; padding:.1em .3em; border-radius:6px; }
.preview blockquote { border-left:3px solid #3a3a44; padding-left:10px; color:#b9b9c4; margin:.5em 0; }
.preview ul, .preview ol { margin:.2em 0 .6em 1.2em; }

.toolbar { display:flex; gap:10px; align-items:center; margin-bottom:8px; }
.switch { display:inline-flex; align-items:center; gap:8px; }
.switch input { accent-color:var(--accent); }

@media (max-width:900px) {
  .backstory-wrap { grid-template-columns:1fr; }
}

@media print {
  body { background:#fff; color:#000; }
  .tabs, .btn { display:none !important; }
  .panel { break-inside:avoid; }
}
